apiVersion: v1
kind: ConfigMap
metadata:
  name: kafka-bridge-config
  labels:
    app: kafka-bridge
  namespace: default

data:
  config.yaml: |
    sourceClusters:
      - name: source-a
        brokers: ["source-cluster:9094"]
        sourceGroupId: filter-source
        tls:
          caFile: /etc/kafka-bridge/tls/ca.pem
          certFile: /etc/kafka-bridge/tls/client-cert.pem
          keyFile: /etc/kafka-bridge/tls/client-key.pem
    bridgeCluster:
      brokers: ["bridge-cluster:9092"]
    clientId: kafka-filter
    referenceGroupId: filter-reference
    commitInterval: 2s
    http:
      listenAddr: ":8080"
    storage:
      path: /var/lib/kafka-bridge/cache.json
      flushInterval: 10s
    routes:
      - name: route-a
        sourceCluster: source-a
        sourceTopic: "source-topic-a"
        destinationTopic: filtered-topic-a
        referenceFeeds:
          - topic: reference-feed-topic-a
            matchFields: ["fieldA"]
          - topic: reference-feed-topic-b
            matchFields: ["subObj.fieldB"]
